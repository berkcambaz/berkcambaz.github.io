import{r as C,i as L,j as s,a as y,u as P,F as I}from"./index-397ef9b3.js";import{u as g,g as i,T as u}from"./gameStore-380c768a.js";import{L as S,b as x,U as O,c as M,d as j,e as R}from"./assets-98c75c96.js";import{F as p,c as k}from"./Flex-57308d9c.js";import{I as l}from"./Image-e76b513d.js";import{c as K,A as f}from"./createReactComponent-7bdf5a0e.js";import{I as N,a as U}from"./IconMessageCircle2-f17a05f2.js";import{M as F}from"./Map-dd43bb1d.js";import"./UnstyledButton-7c9a7b0a.js";var H=Object.defineProperty,z=Object.defineProperties,A=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,v=(e,t,r)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,G=(e,t)=>{for(var r in t||(t={}))D.call(t,r)&&v(e,r,t[r]);if(w)for(var r of w(t))B.call(t,r)&&v(e,r,t[r]);return e},$=(e,t)=>z(e,A(t));function W(e){const t=e.toLowerCase().split("+").map(o=>o.trim()),r={alt:t.includes("alt"),ctrl:t.includes("ctrl"),meta:t.includes("meta"),mod:t.includes("mod"),shift:t.includes("shift")},a=["alt","ctrl","meta","shift","mod"],n=t.find(o=>!a.includes(o));return $(G({},r),{key:n})}function Y(e,t){const{alt:r,ctrl:a,meta:n,mod:o,shift:c,key:d}=e,{altKey:T,ctrlKey:h,metaKey:b,shiftKey:_,key:E}=t;if(r!==T)return!1;if(o){if(!h&&!b)return!1}else if(a!==h||n!==b)return!1;return c!==_?!1:!!(d&&(E.toLowerCase()===d.toLowerCase()||t.code.replace("Key","").toLowerCase()===d.toLowerCase()))}function V(e){return t=>Y(W(e),t)}function X(e,t,r=!1){return e.target instanceof HTMLElement?(r||!e.target.isContentEditable)&&!t.includes(e.target.tagName):!0}function q(e,t=["INPUT","TEXTAREA","SELECT"],r=!1){C.useEffect(()=>{const a=n=>{e.forEach(([o,c,d={preventDefault:!0}])=>{V(o)(n)&&X(n,t,r)&&(d.preventDefault&&n.preventDefault(),c(n))})};return document.documentElement.addEventListener("keydown",a),()=>document.documentElement.removeEventListener("keydown",a)},[e])}var J=K("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]);const Q=k(e=>({header:{position:"absolute",left:0,right:0,height:"64px",zIndex:1,backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0))"}}));function Z(){const e=L(),{classes:t}=Q(),r=g(a=>a.data);return s(p,{className:t.header,direction:"row",align:"center",justify:"center",gap:"md",children:y(p,{children:[[-4,-3,-2,-1].map((a,n)=>s(l,{src:m(i.util.getTurnType(r,r.turn.count+a)),style:{width:32,height:32,userSelect:"none",borderBottomLeftRadius:a===-4?e.radius.md:void 0},bg:"rgb(255, 255, 255, 0.5)"},n)),s(l,{src:m(r.turn.type),style:{width:64,height:64,userSelect:"none",borderRadius:`0 0 ${e.radius.md} ${e.radius.md}`},bg:"rgb(255, 255, 255, 0.5)"}),[1,2,3,4].map((a,n)=>s(l,{src:m(i.util.getTurnType(r,r.turn.count+a)),style:{width:32,height:32,userSelect:"none",borderBottomRightRadius:a===4?e.radius.md:void 0},bg:"rgb(255, 255, 255, 0.5)"},n))]})})}function m(e){switch(e){case u.CountryGreen:return R;case u.CountryPurple:return j;case u.CountryRed:return M;case u.CountryYellow:return O;case u.Banner:return x;case u.Chest:return S;default:return}}const ee=k(e=>({footer:{position:"absolute",bottom:0,left:0,right:0,height:"64px",zIndex:1,backgroundImage:"linear-gradient(0deg, rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0))"}}));function te(){const e=P(),{classes:t}=ee(),r=()=>{e("/lobby")},a=()=>{e("/chat")},n=()=>{g.setState(o=>{var c;i.play.nextTurn(o.data,{country:(c=o.country)==null?void 0:c.id}),o.country=i.util.turnTypeToCountry(o.data,o.data.turn.type),o.moveableTiles=[],o.selectedUnitTile=void 0})};return q([["1",()=>r()],["2",()=>a()],["3",()=>n()]]),y(p,{className:t.footer,direction:"row",align:"center",justify:"center",gap:"md",children:[s(f,{variant:"filled",size:32,onClick:r,children:s(J,{})}),s(f,{variant:"filled",size:32,onClick:a,children:s(N,{})}),s(f,{variant:"filled",size:32,onClick:n,children:s(U,{})})]})}function le(){return C.useEffect(()=>{g.setState(e=>{e.data.running||(i.play.generate(e.data,{w:e.data.width,h:e.data.height,seed:e.data.seed}),i.play.start(e.data,{}),e.country=i.util.turnTypeToCountry(e.data,e.data.turn.type))})},[]),y(I,{children:[s(Z,{}),s(te,{}),s(F,{})]})}export{le as default};
