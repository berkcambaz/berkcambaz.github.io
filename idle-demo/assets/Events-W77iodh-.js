import{aA as A,aB as S,e as M,aC as Q,k as I,aD as R,aE as F,aF as b,a1 as B,j as e,C as J,F as x,T as E,o as T,p as K,y as N,a7 as h,B as V,a2 as U,i as f,g as z,a as L,aG as O,aH as H,l as W,r as Y,av as D,D as C,t as $}from"./index-d3W-edxA.js";import{F as G,R as g}from"./FullscreenModal-0lPMFZBf.js";import{S as y}from"./ScrollArea-_rrQgZ6K.js";import{u as k}from"./use-disclosure-JhSf_ZMC.js";function P(s,n){const o=A(s,{id:n.achievementId}),t=S({id:n.achievementId});return!(o<t||s.events.achievements.collected[n.achievementId])}function X(s,n){P(s,n)&&(s.events.achievements.collected[n.achievementId]=!0,M(s,{toAdd:Q[n.achievementId].rewards}))}function _(s,n){const o=new Date(s.events.dailyQuests.startDate),t=new Date(I(Date.now()));if(o.getUTCFullYear()!==t.getUTCFullYear()||o.getUTCMonth()!==t.getUTCMonth()||o.getUTCDate()!==t.getUTCDate())return!1;const r=R(s,{id:n.dailyQuestId}),d=F({id:n.dailyQuestId});return!(r<d||s.events.dailyQuests.collected[n.dailyQuestId])}function Z(s,n){_(s,n)&&(s.events.dailyQuests.collected[n.dailyQuestId]=!0,M(s,{toAdd:b[n.dailyQuestId].rewards}))}function ee(s,n){const o=new Date,t=new Date(I(s.events.dailyQuests.startDate));return!(o.getTime()<t.getTime())}function te(s,n){ee(s)&&(s.events.dailyQuests={startDate:Date.now(),progress:{},collected:{}})}var se=B("circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),ne=B("circle","IconCircle",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}]]);function q({name:s,rewards:n,done:o,todo:t,onCollect:r,collectible:d,collected:u}){return e.jsx(J,{withBorder:!0,radius:"md",children:e.jsxs(x,{direction:"column",gap:"xs",children:[e.jsx(E,{order:6,children:s}),e.jsx(y,{children:e.jsx(x,{gap:"xs",children:n.map(a=>a.item?e.jsx(T,{item:a.item},K(a.item)):e.jsx(T,{monster:a.monster},N(a.monster)))})}),e.jsxs(x,{gap:"md",align:"center",children:[e.jsx(h.Root,{size:"xl",style:{flex:1},children:e.jsx(h.Section,{value:o/t*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${o} / ${t}`})})}),e.jsx(V,{onClick:r,disabled:!d,leftSection:u?e.jsx(se,{}):e.jsx(ne,{}),children:"Collect"})]})]})})}function oe({opened:s,onClose:n}){var v,w;const{t:o}=U(),t=f(c=>c.player),r=((v=t==null?void 0:t.items[z])==null?void 0:v.count)??0,d=((w=t==null?void 0:t.items[L])==null?void 0:w.count)??0,u=t?O(t):0,a=H(),j=t?I(t.events.dailyQuests.startDate):Date.now(),i=W(j,()=>{f.setState(c=>{c.player&&te(c.player)})}),l=Y.useMemo(()=>t?Object.keys(b).map(c=>{const m={id:c};return{name:o(m.id),rewards:b[m.id].rewards,done:t?R(t,m):0,todo:F(m),onCollect(){f.setState(p=>{p.player&&Z(p.player,{dailyQuestId:m.id})})},collectible:_(t,{dailyQuestId:m.id}),collected:!!(t!=null&&t.events.dailyQuests.collected[m.id])}}).sort((c,m)=>c.collectible||m.collected?-1:0):[],[t]);return e.jsx(G,{opened:s,onClose:n,header:e.jsxs(e.Fragment,{children:[e.jsx(D,{emoji:"ðŸª™",count:r}),e.jsx(D,{emoji:"ðŸ’Ž",count:d})]}),children:e.jsx(y,{h:"100%",children:e.jsxs(x,{direction:"column",gap:"md",h:"100%",children:[e.jsx(C,{label:"Daily Quests"}),e.jsx(h.Root,{size:24,w:"100%",children:e.jsx(h.Section,{value:u/a*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${u} / ${a}`})})}),e.jsxs(E,{order:6,ta:"center",children:["Resets in ",i]}),l.map(c=>e.jsx(q,{...c},c.name))]})})})}function ae({opened:s,onClose:n}){var a,j;const{t:o}=U(),t=f(i=>i.player),r=((a=t==null?void 0:t.items[z])==null?void 0:a.count)??0,d=((j=t==null?void 0:t.items[L])==null?void 0:j.count)??0,u=Y.useMemo(()=>t?Object.keys(Q).map(i=>{const l={id:i};return{name:o(l.id),rewards:Q[l.id].rewards,done:t?A(t,l):0,todo:S(l),onCollect(){f.setState(v=>{v.player&&X(v.player,{achievementId:l.id})})},collectible:P(t,{achievementId:l.id}),collected:!!(t!=null&&t.events.achievements.collected[l.id])}}).sort((i,l)=>i.collectible||l.collected?-1:0):[],[t]);return e.jsx(G,{opened:s,onClose:n,header:e.jsxs(e.Fragment,{children:[e.jsx(D,{emoji:"ðŸª™",count:r}),e.jsx(D,{emoji:"ðŸ’Ž",count:d})]}),children:e.jsx(y,{h:"100%",children:e.jsxs(x,{direction:"column",gap:"md",h:"100%",children:[e.jsx(C,{label:"Achievements"}),u.map(i=>e.jsx(q,{...i},i.name))]})})})}function de(){const[s,{open:n,close:o}]=k(),[t,{open:r,close:d}]=k(),u=f(i=>i.player),a=u?O(u):0,j=H();return e.jsxs(e.Fragment,{children:[e.jsx(y,{children:e.jsxs(x,{direction:"column",gap:"md",children:[e.jsx(C,{label:"Continuous Events"}),e.jsx(g,{emoji:"ðŸ“‹",title:"Daily Quests",onClick:n,children:e.jsx(h.Root,{size:"xl",mt:"xs",w:"100%",children:e.jsx(h.Section,{value:a/j*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${a} / ${j}`})})})}),e.jsx(g,{emoji:"ðŸŽ¯",title:"Achievements",onClick:r}),e.jsx(C,{label:"Limited Events"}),e.jsx(g,{emoji:"ðŸ˜ˆ",title:"Monster Hunt",onClick:()=>{},children:e.jsx($,{ta:"left",size:"sm",c:"yellow",children:"Coming soon..."})}),e.jsx(g,{emoji:"ðŸ’³",title:"Spending Spree",onClick:()=>{},children:e.jsx($,{ta:"left",size:"sm",c:"yellow",children:"Coming soon..."})})]})}),e.jsx(oe,{opened:s,onClose:o}),e.jsx(ae,{opened:t,onClose:d})]})}export{de as default};
