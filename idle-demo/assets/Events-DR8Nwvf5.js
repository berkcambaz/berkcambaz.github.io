import{aD as S,aE as A,b as M,aF as Q,k as I,aG as R,aH as F,aI as b,a2 as E,j as e,C as _,F as x,T as U,S as C,o as p,p as q,y as N,a8 as h,B as V,a3 as z,i as f,g as B,e as L,aJ as O,aK as H,l as W,r as Y,D,ay as y,t as $}from"./index-D2NeptHS.js";import{F as G,R as v}from"./FullscreenModal-DPUXCQSu.js";import{u as k}from"./use-disclosure-U3OCajE0.js";function J(s,n){const o=S(s,{id:n.achievementId}),t=A({id:n.achievementId});return!(o<t||s.events.achievements.collected[n.achievementId])}function X(s,n){J(s,n)&&(s.events.achievements.collected[n.achievementId]=!0,M(s,{toAdd:Q[n.achievementId].rewards}))}function K(s,n){const o=new Date(s.events.dailyQuests.startDate),t=new Date(I(Date.now()));if(o.getUTCFullYear()!==t.getUTCFullYear()||o.getUTCMonth()!==t.getUTCMonth()||o.getUTCDate()!==t.getUTCDate())return!1;const r=R(s,{id:n.dailyQuestId}),d=F({id:n.dailyQuestId});return!(r<d||s.events.dailyQuests.collected[n.dailyQuestId])}function Z(s,n){K(s,n)&&(s.events.dailyQuests.collected[n.dailyQuestId]=!0,M(s,{toAdd:b[n.dailyQuestId].rewards}))}function ee(s,n){const o=new Date,t=new Date(I(s.events.dailyQuests.startDate));return!(o.getTime()<t.getTime())}function te(s,n){ee(s)&&(s.events.dailyQuests={startDate:Date.now(),progress:{},collected:{}})}var se=E("circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),ne=E("circle","IconCircle",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}]]);function P({name:s,rewards:n,done:o,todo:t,onCollect:r,collectible:d,collected:u}){return e.jsx(_,{withBorder:!0,radius:"md",children:e.jsxs(x,{direction:"column",gap:"xs",children:[e.jsx(U,{order:6,children:s}),e.jsx(C,{children:e.jsx(x,{gap:"xs",children:n.map(a=>a.item?e.jsx(p,{item:a.item},q(a.item)):e.jsx(p,{monster:a.monster},N(a.monster)))})}),e.jsxs(x,{gap:"md",align:"center",children:[e.jsx(h.Root,{size:"xl",style:{flex:1},children:e.jsx(h.Section,{value:o/t*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${o} / ${t}`})})}),e.jsx(V,{onClick:r,disabled:!d,leftSection:u?e.jsx(se,{}):e.jsx(ne,{}),children:"Collect"})]})]})})}function oe({opened:s,onClose:n}){var g,w;const{t:o}=z(),t=f(c=>c.player),r=((g=t==null?void 0:t.items[B])==null?void 0:g.count)??0,d=((w=t==null?void 0:t.items[L])==null?void 0:w.count)??0,u=t?O(t):0,a=H(),j=t?I(t.events.dailyQuests.startDate):Date.now(),i=W(j,()=>{f.setState(c=>{c.player&&te(c.player)})}),l=Y.useMemo(()=>t?Object.keys(b).map(c=>{const m={id:c};return{name:o(m.id),rewards:b[m.id].rewards,done:t?R(t,m):0,todo:F(m),onCollect(){f.setState(T=>{T.player&&Z(T.player,{dailyQuestId:m.id})})},collectible:K(t,{dailyQuestId:m.id}),collected:!!(t!=null&&t.events.dailyQuests.collected[m.id])}}).sort((c,m)=>c.collectible||m.collected?-1:0):[],[t]);return e.jsx(G,{opened:s,onClose:n,header:e.jsxs(e.Fragment,{children:[e.jsx(y,{emoji:"ðŸª™",count:r}),e.jsx(y,{emoji:"ðŸ’Ž",count:d})]}),children:e.jsx(C,{h:"100%",children:e.jsxs(x,{direction:"column",gap:"md",h:"100%",children:[e.jsx(D,{label:"Daily Quests"}),e.jsx(h.Root,{size:24,w:"100%",children:e.jsx(h.Section,{value:u/a*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${u} / ${a}`})})}),e.jsxs(U,{order:6,ta:"center",children:["Resets in ",i]}),l.map(c=>e.jsx(P,{...c},c.name))]})})})}function ae({opened:s,onClose:n}){var a,j;const{t:o}=z(),t=f(i=>i.player),r=((a=t==null?void 0:t.items[B])==null?void 0:a.count)??0,d=((j=t==null?void 0:t.items[L])==null?void 0:j.count)??0,u=Y.useMemo(()=>t?Object.keys(Q).map(i=>{const l={id:i};return{name:o(l.id),rewards:Q[l.id].rewards,done:t?S(t,l):0,todo:A(l),onCollect(){f.setState(g=>{g.player&&X(g.player,{achievementId:l.id})})},collectible:J(t,{achievementId:l.id}),collected:!!(t!=null&&t.events.achievements.collected[l.id])}}).sort((i,l)=>i.collectible||l.collected?-1:0):[],[t]);return e.jsx(G,{opened:s,onClose:n,header:e.jsxs(e.Fragment,{children:[e.jsx(y,{emoji:"ðŸª™",count:r}),e.jsx(y,{emoji:"ðŸ’Ž",count:d})]}),children:e.jsx(C,{h:"100%",children:e.jsxs(x,{direction:"column",gap:"md",h:"100%",children:[e.jsx(D,{label:"Achievements"}),u.map(i=>e.jsx(P,{...i},i.name))]})})})}function re(){const[s,{open:n,close:o}]=k(),[t,{open:r,close:d}]=k(),u=f(i=>i.player),a=u?O(u):0,j=H();return e.jsxs(e.Fragment,{children:[e.jsx(C,{children:e.jsxs(x,{direction:"column",gap:"md",children:[e.jsx(D,{label:"Continuous Events"}),e.jsx(v,{emoji:"ðŸ“‹",title:"Daily Quests",onClick:n,children:e.jsx(h.Root,{size:"xl",mt:"xs",w:"100%",children:e.jsx(h.Section,{value:a/j*100,children:e.jsx(h.Label,{pos:"absolute",style:{transform:"translate(-50%,0)",left:"50%"},children:`${a} / ${j}`})})})}),e.jsx(v,{emoji:"ðŸŽ¯",title:"Achievements",onClick:r}),e.jsx(D,{label:"Limited Events"}),e.jsx(v,{emoji:"ðŸ˜ˆ",title:"Monster Hunt",onClick:()=>{},children:e.jsx($,{ta:"left",size:"sm",c:"yellow",children:"Coming soon..."})}),e.jsx(v,{emoji:"ðŸ’³",title:"Spending Spree",onClick:()=>{},children:e.jsx($,{ta:"left",size:"sm",c:"yellow",children:"Coming soon..."})})]})}),e.jsx(oe,{opened:s,onClose:o}),e.jsx(ae,{opened:t,onClose:d})]})}export{re as default};
