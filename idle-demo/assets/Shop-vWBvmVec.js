import{g as T,a as y,s as f,b as p,v as u,c as z,d as B,e as S,u as x,f as G,h as A,j as e,F as a,T as w,D as m,E as c,i as F,k as L,C as R,l as C,m as E,B as k,n as b,o as P,p as v}from"./index-LKG6ecAX.js";import{C as H}from"./ContentAsset-buRFZ2Lb.js";import{C as d}from"./ContentList-NdGfWjdq.js";import{S as N}from"./ScrollArea-MB6Bf0Xn.js";function $(s,n){var l,h;let t,i=0,r=((l=s.items[T])==null?void 0:l.count)??0,g=((h=s.items[y])==null?void 0:h.count)??0;switch(n.shop){case"gold":if(t=p[n.index],i=s.shop.gold[n.index]??0,!t||(t.price.gold??0)>r)return!1;break;case"gem":if(t=f[n.index],i=s.shop.gem[n.index]??0,!t||(t.price.gem??0)>g)return!1;break;default:return!0}return!(u===s.shop.snapshot&&t.limit>0&&t.limit<=i)}function Q(s,n){if(!$(s,n))return;u!==s.shop.snapshot&&(s.shop={snapshot:u,startDate:Date.now(),premium:{},gold:{},gem:{}});let t,i=[];switch(n.shop){case"gold":t=p[n.index],i.push({item:B((t==null?void 0:t.price.gold)??0)});break;case"gem":t=f[n.index],i.push({item:z((t==null?void 0:t.price.gem)??0)});break}t&&(s.shop[n.shop][n.index]||(s.shop[n.shop][n.index]=0),s.shop[n.shop][n.index]++,S(s,{toRemove:i}),S(s,{toAdd:[{item:t.item}]}))}function U(s,n){const t=new Date,i=new Date(_(s.shop.startDate));return!(t.getTime()<i.getTime())}function W(s,n){U(s)&&(s.shop={snapshot:u,startDate:Date.now(),premium:{},gold:{},gem:{}})}function _(s){const n=new Date(s);return n.setUTCHours(23,59,59),n.getTime()}function V(){const s=x(i=>i.player),n=s?G(s.events.dailyQuests.startDate):Date.now(),t=A(n,()=>{x.setState(i=>{i.player&&W(i.player)})});return e.jsx(N,{scrollbars:"y",children:e.jsxs(a,{direction:"column",gap:"md",children:[e.jsxs(w,{order:6,ta:"center",children:["Shop resets in ",t]}),e.jsx(m,{label:e.jsxs(a,{align:"center",children:[e.jsx(c,{emoji:"âœ¨",size:16}),"Â Special Offer"]})}),e.jsx(q,{specialOffer:F,onBuy:()=>{}}),e.jsx(m,{label:e.jsxs(a,{align:"center",children:[e.jsx(c,{emoji:"ðŸ‘‘",size:16}),"Â Premium Shop"]})}),e.jsx(d,{gap:"xs",children:L.map((i,r)=>e.jsx(j,{shop:"premium",index:r,shopItem:i},r))}),e.jsx(m,{label:e.jsxs(a,{align:"center",children:[e.jsx(c,{emoji:"ðŸª™",size:16}),"Â Gold Shop"]})}),e.jsx(d,{gap:"xs",children:p.map((i,r)=>e.jsx(j,{shop:"gold",index:r,shopItem:i},r))}),e.jsx(m,{label:e.jsxs(a,{align:"center",children:[e.jsx(c,{emoji:"ðŸ’Ž",size:16}),"Â Gem Shop"]})}),e.jsx(d,{gap:"xs",children:f.map((i,r)=>e.jsx(j,{shop:"gem",index:r,shopItem:i},r))})]})})}function q({specialOffer:s,onBuy:n}){const t=i=>{v.setState(r=>{r.modals.itemDetails={opened:!0,item:i}})};return e.jsx(R,{withBorder:!0,styles:{root:{backgroundImage:"url(/idle-demo/gggrain.svg)"}},children:e.jsxs(a,{direction:"column",align:"center",gap:"xs",children:[e.jsx(H,{size:100,image:s.asset.image,emoji:s.asset.emoji}),e.jsx(w,{order:3,c:"white",children:s.name}),e.jsx(a,{direction:"column",w:"100%",children:e.jsx(d,{gap:"xs",children:s.items.map(i=>e.jsx(C,{item:i,onClick:()=>t(i)},E(i)))})}),e.jsx(k,{w:"100%",maw:128,onClick:n,children:`Buy for $${s.money}`})]})})}function j({shop:s,index:n,shopItem:t}){const i=x(o=>o.player),r=()=>{v.setState(o=>{o.modals.itemDetails={opened:!0,item:t.item}})},g=()=>{x.setState(o=>{o.player&&Q(o.player,{shop:s,index:n})})},l=()=>i?$(i,{shop:s,index:n}):!1,D=i?t.limit-(i.shop[s][n]??0):t.limit;return e.jsxs(a,{direction:"column",align:"center",w:64,children:[e.jsx(C,{item:t.item,onClick:r}),e.jsxs(k,{fullWidth:!0,size:"compact-sm",px:0,mt:"xs",onClick:g,disabled:!l(),children:[t.price.money!==void 0&&e.jsxs(e.Fragment,{children:["$",t.price.money]}),t.price.gem!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx(c,{emoji:"ðŸ’Ž"}),"Â ",b(t.price.gem)]}),t.price.gold!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx(c,{emoji:"ðŸª™"}),"Â ",b(t.price.gold)]})]}),e.jsx(P,{size:"xs",my:"xs",children:`Limit ${D<0?"âˆž":D}`})]})}export{V as default};
