import{r as g,s as le,b as p,c as ie,u as Fe,d as De,t as Be,v as ze,R as _,w as Ue,B as Z,n as b,j as o,F as v,k as I,x as P,y as Ve,I as k,f as m,i as u,z as O,A as We,D as Le,G as Ge,H as qe,l as w,g as h,J as U,m as ce,h as V,C as ee,T as z,E as te,K as C}from"./index-509871e5.js";import{g as M,I as He,M as Je}from"./MonsterStats-4a9609af.js";function Ke({value:e,defaultValue:t,finalValue:r,onChange:n=()=>{}}){const[s,l]=g.useState(t!==void 0?t:r),c=d=>{l(d),n==null||n(d)};return e!==void 0?[e,n,!0]:[s,c,!1]}const Xe={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function Qe(){const e=g.useRef(0),t=g.useRef(null),[r,n]=g.useState(Xe),s=g.useMemo(()=>typeof window<"u"?new ResizeObserver(l=>{const c=l[0];c&&(cancelAnimationFrame(e.current),e.current=requestAnimationFrame(()=>{t.current&&n(c.contentRect)}))}):null,[]);return le(()=>(t.current&&(s.observe(t.current),n(t.current.getBoundingClientRect())),()=>{s.disconnect(),e.current&&cancelAnimationFrame(e.current)}),[t.current]),[t,r]}var Ye=Object.defineProperty,Ze=Object.defineProperties,et=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable,ne=(e,t,r)=>t in e?Ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))tt.call(t,r)&&ne(e,r,t[r]);if(re)for(var r of re(t))rt.call(t,r)&&ne(e,r,t[r]);return e},nt=(e,t)=>Ze(e,et(t));const N=4,oe={xs:`${p(3)} ${p(6)}`,sm:`${p(5)} ${p(10)}`,md:`${p(7)} ${p(14)}`,lg:`${p(9)} ${p(16)}`,xl:`${p(12)} ${p(20)}`};var ot=ie((e,{fullWidth:t,color:r,radius:n,shouldAnimate:s,transitionDuration:l,transitionTimingFunction:c,orientation:d},{size:a})=>{const f=d==="vertical",x=e.fn.variant({variant:"filled",color:r});return{label:nt(E(E({ref:M("label")},e.fn.focusStyles()),e.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",borderRadius:e.fn.radius(n),fontWeight:500,fontSize:a in e.fontSizes?e.fontSizes[a]:e.fontSizes.sm,cursor:"pointer",display:"block",textAlign:"center",padding:oe[a in oe?a:"sm"],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",color:e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[7],transition:`color ${s?0:l}ms ${c||e.transitionTimingFunction}`,"&:hover":{color:e.colorScheme==="dark"?e.colors.dark[0]:e.black},"&[data-disabled]":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}},"&[data-active]":{"&, &:hover":{color:r||e.colorScheme==="dark"?e.white:e.black}}}),control:{ref:M("control"),position:"relative",boxSizing:"border-box",flex:1,zIndex:2,transition:`border-left-color ${s?0:l}ms ${c||e.transitionTimingFunction}`,"&:not(:first-of-type)":{borderStyle:"solid",borderWidth:f?`${p(1)} 0 0 0`:`0 0 0 ${p(1)}`,borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}},input:{height:0,width:0,position:"absolute",overflow:"hidden",whiteSpace:"nowrap",opacity:0,"&:focus":{outline:"none",[`& + .${M("label")}`]:E({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),"&:focus:not(:focus-visible)":{[`& + .${M("label")}`]:E({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)}},"&:disabled + label":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}}},root:{position:"relative",display:t||f?"flex":"inline-flex",width:f&&!t?"max-content":"auto",flexDirection:f?"column":"row",backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[1],borderRadius:e.fn.radius(n),overflow:"hidden",padding:N},controlActive:{borderLeftColor:"transparent !important",borderTopColor:"transparent !important",[`& + .${M("control")}`]:{[f?"borderTopColor":"borderLeftColor"]:"transparent !important"},borderRadius:e.fn.radius(n),boxShadow:s?r||e.colorScheme==="dark"?"none":e.shadows.xs:void 0,backgroundColor:s?r?x.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white:void 0},indicator:{boxSizing:"border-box",borderRadius:e.fn.radius(n),position:"absolute",zIndex:1,boxShadow:r||e.colorScheme==="dark"?"none":e.shadows.xs,transition:`transform ${s?0:l}ms ${e.transitionTimingFunction}, width ${s?0:l/2}ms ${c||e.transitionTimingFunction}`,backgroundColor:r?x.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white}}});const st=ot;var at=Object.defineProperty,A=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,se=(e,t,r)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lt=(e,t)=>{for(var r in t||(t={}))de.call(t,r)&&se(e,r,t[r]);if(A)for(var r of A(t))ue.call(t,r)&&se(e,r,t[r]);return e},it=(e,t)=>{var r={};for(var n in e)de.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&A)for(var n of A(e))t.indexOf(n)<0&&ue.call(e,n)&&(r[n]=e[n]);return r};const ct={disabled:!1,size:"sm",transitionDuration:200},W=g.forwardRef((e,t)=>{var r,n,s,l;const c=Fe("SegmentedControl",ct,e),{className:d,disabled:a,data:f,name:x,value:y,onChange:F,color:pe,fullWidth:ge,radius:ve,size:xe,transitionDuration:ye,transitionTimingFunction:he,classNames:be,styles:we,defaultValue:je,orientation:Se,unstyled:Ie,variant:ke,readOnly:Ce}=c,Re=it(c,["className","disabled","data","name","value","onChange","color","fullWidth","radius","size","transitionDuration","transitionTimingFunction","classNames","styles","defaultValue","orientation","unstyled","variant","readOnly"]),L=De(),$e=Be(),_e=L.respectReducedMotion?$e:!1,R=f.map(i=>typeof i=="string"?{label:i,value:i}:i),G=g.useRef(),[q,H]=g.useState(!1),[j,Pe]=Ke({value:y,defaultValue:je,finalValue:Array.isArray(R)&&(l=(s=(r=R.find(i=>!i.disabled))==null?void 0:r.value)!=null?s:(n=R[0])==null?void 0:n.value)!=null?l:null,onChange:F}),{classes:S,cx:J}=st({fullWidth:ge,color:pe,radius:ve,shouldAnimate:_e||!q,transitionDuration:ye,transitionTimingFunction:he,orientation:Se},{name:"SegmentedControl",classNames:be,styles:we,unstyled:Ie,variant:ke,size:xe}),[T,Oe]=g.useState({width:0,height:0,translate:[0,0]}),D=ze(x),B=g.useRef({}),[K,X]=Qe();le(()=>{G.current?H(!0):(G.current=!0,H(!1))}),g.useEffect(()=>{if(j in B.current&&K.current){const i=B.current[j],$=i.getBoundingClientRect(),Q=i.offsetWidth/$.width,Y=$.width*Q||0,Ee=$.height*Q||0,Ne=X.width-i.parentElement.offsetLeft+N-Y,Ae=i.parentElement.offsetLeft-N;Oe({width:Y,height:Ee,translate:[L.dir==="rtl"?Ne:Ae,i.parentElement.offsetTop-N]})}},[j,X]);const Me=R.map(i=>_.createElement("div",{className:J(S.control,{[S.controlActive]:j===i.value}),key:i.value},_.createElement("input",{className:S.input,disabled:a||i.disabled,type:"radio",name:D,value:i.value,id:`${D}-${i.value}`,checked:j===i.value,onChange:()=>!Ce&&Pe(i.value)}),_.createElement("label",{className:S.label,"data-active":j===i.value&&!(a||i.disabled)||void 0,"data-disabled":a||i.disabled||void 0,htmlFor:`${D}-${i.value}`,ref:$=>{B.current[i.value]=$}},i.label))),Te=Ue(K,t);return R.length===0?null:_.createElement(Z,lt({className:J(S.root,d),ref:Te},Re),typeof j=="string"&&q&&_.createElement(Z,{component:"span",className:S.indicator,sx:{width:T.width,height:T.height,transform:`translate(${T.translate[0]}px, ${T.translate[1]}px)`}}),Me)});W.displayName="@mantine/core/SegmentedControl";const dt={act:ut,actable:fe};function fe(e,t){if(!e.inventory.monsters[t.monsterIndex])return!1;const n=t.itemId&&e.inventory.items[t.itemId];return!(t.itemId!==void 0&&!n||n&&n.count<=0)}function ut(e,t){if(!fe(e,t))return;const r=e.inventory.monsters[t.monsterIndex];if(!r)return;const n=t.itemId&&e.inventory.items[t.itemId],s=r[t.type];s&&(e.inventory.items[s]||(e.inventory.items[s]={id:s,count:0}),e.inventory.items[s].count++),r[t.type]=n?n.id:void 0,n&&n.count--,t.itemId&&n&&n.count===0&&delete e.inventory.items[t.itemId]}function ft(){const e=b(s=>s.data.inventory.currentMonsterIndex),t=b(s=>s.data.inventory.monsters[e]),r=b(s=>s.data.inventory),n=(s,l)=>{w.setState(c=>{c.modals.itemPicker.opened=!0,c.modals.itemPicker.items=h.sortItems(Object.keys(s).map(d=>r.items[d]).filter(Boolean)),t&&t[l]&&c.modals.itemPicker.items.push(void 0),c.modals.itemPicker.callback=d=>{w.setState(a=>{a.modals.itemPicker.opened=!1}),b.setState(a=>{dt.act(a.data,{itemId:d==null?void 0:d.id,monsterIndex:e,type:l})})}})};return t?o.jsxs(o.Fragment,{children:[o.jsx(v,{direction:"column",align:"center",children:o.jsx(I,{variant:"default",h:"auto",p:"md",onClick:()=>n(Ve,P.Weapon),children:t.weapon?o.jsx(O,{src:m.url(u[t.weapon].path),stars:u[t.weapon].stars}):o.jsx(k,{src:m.url(u["Common Axe"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})}),o.jsxs(v,{direction:"row",justify:"center",gap:"xl",children:[o.jsx(I,{variant:"default",h:"auto",p:"md",mr:"xl",onClick:()=>n(We,P.Armor),children:t.armor?o.jsx(O,{src:m.url(u[t.armor].path),stars:u[t.armor].stars}):o.jsx(k,{src:m.url(u["Common Banded Mail 1 Armor"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})}),o.jsx(I,{variant:"default",h:"auto",p:"md",ml:"xl",onClick:()=>n(Le,P.Amulet),children:t.amulet?o.jsx(O,{src:m.url(u[t.amulet].path),stars:u[t.amulet].stars}):o.jsx(k,{src:m.url(u["Common Cameo Blue Amulet"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})]}),o.jsxs(v,{direction:"row",justify:"center",gap:"md",children:[o.jsx(I,{variant:"default",h:"auto",p:"md",onClick:()=>n(Ge,P.Rune),children:t.rune?o.jsx(O,{src:m.url(u[t.rune].path),stars:u[t.rune].stars}):o.jsx(k,{src:m.url(u["Common Generic Rune"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})}),o.jsx(I,{variant:"default",h:"auto",p:"md",onClick:()=>n(qe,P.Ring),children:t.ring?o.jsx(O,{src:m.url(u[t.ring].path),stars:u[t.ring].stars}):o.jsx(k,{src:m.url(u["Common Agate Ring"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})]})]}):null}const ae={act:mt,actable:me};function me(e,t){const r=e.inventory.monsters[t.monsterIndex];if(!r||e.player.level<=r.level)return!1;const n=U.getMonsterUpgradeCost(r.level);return!(n.gold>e.player.gold||n.food>e.player.food)}function mt(e,t){if(!me(e,t))return;const r=e.inventory.monsters[t.monsterIndex];if(!r)return;const n=U.getMonsterUpgradeCost(r.level);e.player.gold-=n.gold,e.player.food-=n.food,r.level++,U.sortMonsters(e)}const pt=ie(e=>({inventoryTop:{[e.fn.largerThan(640)]:{flex:1,height:320}}}));function wt(){return o.jsxs(v,{direction:"column",gap:"md",mx:"md",my:80,children:[o.jsx(gt,{}),o.jsx(vt,{})]})}function gt(){const{classes:e}=pt(),t=w(y=>y.segments.inventoryTop),r=y=>{w.setState(F=>{F.segments.inventoryTop=y})},n=b(y=>y.data),s=n.inventory.currentMonsterIndex,l=n.inventory.monsters[s],c=l?m.url(ce[l.id].path):void 0,d=l&&V.util.getMonsterStats(l),a=l&&V.util.getMonsterUpgradeCost(l==null?void 0:l.level),f=ae.actable(n,{monsterIndex:s}),x=()=>{b.setState(y=>{ae.act(y.data,{monsterIndex:s})})};return o.jsxs(v,{direction:"row",justify:"center",gap:"md",wrap:"wrap",children:[o.jsx(ee,{withBorder:!0,w:"100%",className:e.inventoryTop,children:o.jsxs(v,{direction:"column",align:"center",justify:"center",gap:"md",h:"100%",children:[o.jsx(z,{order:3,children:l==null?void 0:l.id}),o.jsx(k,{src:c,width:64,height:64,style:{imageRendering:"pixelated"}})]})}),o.jsx(ee,{withBorder:!0,w:"100%",className:e.inventoryTop,children:o.jsxs(v,{direction:"column",gap:"md",children:[o.jsx(W,{fullWidth:!0,value:t,onChange:r,data:[{label:"Info",value:"info"},{label:"Items",value:"items"}]}),t==="info"&&o.jsxs(o.Fragment,{children:[o.jsxs(v,{align:"center",gap:"md",wrap:"wrap",children:[o.jsx(I,{onClick:x,disabled:!f,leftIcon:o.jsx(He,{}),children:"Upgrade"}),o.jsxs(v,{gap:"xs",children:[o.jsx(te,{emoji:"🪙",style:{width:24,height:24}}),o.jsx(z,{order:5,children:a&&h.formatNumber(a.gold)}),o.jsx(te,{emoji:"🍏",style:{width:24,height:24}}),o.jsx(z,{order:5,children:a&&h.formatNumber(a.food)})]})]}),d&&o.jsx(Je,{...d})]}),t==="items"&&o.jsx(ft,{})]})})]})}function vt(){const e=w(r=>r.segments.inventoryBottom),t=r=>{w.setState(n=>{n.segments.inventoryBottom=r})};return o.jsxs(o.Fragment,{children:[o.jsx(W,{value:e,onChange:t,data:[{label:"Monsters",value:"monsters"},{label:"Items",value:"items"}]}),e==="monsters"&&o.jsx(xt,{}),e==="items"&&o.jsx(yt,{})]})}function xt(){const e=b(r=>r.data),t=r=>{b.setState(n=>{n.data.inventory.currentMonsterIndex=r})};return o.jsx(o.Fragment,{children:o.jsx(v,{direction:"row",gap:"md",wrap:"wrap",children:e.inventory.monsters.map((r,n)=>o.jsx(C,{src:m.url(ce[r.id].path),count:r.level,onClick:()=>t(n),selected:e.inventory.currentMonsterIndex===n},n))})})}function yt(){const e=b(a=>a.data),t=g.useMemo(()=>h.sortItems(Object.values(e.inventory.items)),[e.inventory.items]),r=a=>{w.setState(f=>{f.modals.itemInfo.opened=!0,f.modals.itemInfo.item=a})},n=(a,f)=>{w.setState(x=>{x.modals.itemInfo.opened=!0,x.modals.itemInfo.other={name:a,text:f}})},s=`${h.formatNumber(e.player.gold,!0)} Gold`,l=`${h.formatNumber(e.player.diamond,!0)} Diamond`,c=`${h.formatNumber(e.player.food,!0)} Food`,d=h.formatNumber(e.player.xp,!0)+" / "+h.formatNumber(V.util.getLevelUpXp(e.player.level),!0)+" Experience";return o.jsx(o.Fragment,{children:o.jsxs(v,{direction:"row",gap:"md",wrap:"wrap",children:[o.jsx(C,{emoji:"⭐",count:e.player.level,onClick:()=>n("level",d)}),o.jsx(C,{emoji:"🪙",count:e.player.gold,onClick:()=>n("gold",s)}),o.jsx(C,{emoji:"💎",count:e.player.diamond,onClick:()=>n("diamond",l)}),o.jsx(C,{emoji:"🍏",count:e.player.food,onClick:()=>n("food",c)}),t.map((a,f)=>o.jsx(C,{src:m.url(u[a.id].path),stars:a&&u[a.id].stars,count:a.count,onClick:()=>r(a)},f))]})})}export{wt as default};
