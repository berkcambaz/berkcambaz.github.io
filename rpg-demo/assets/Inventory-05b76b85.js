import{r as x,w as Ce,c as se,b as m,x as Ze,y as et,u as Ee,R as I,B as ae,d as tt,z as rt,A as nt,D as ot,G as W,n as j,j as o,F as h,h as y,H as Z,k as S,J as g,I as P,f as b,i as v,K as B,L as ee,N as te,O as re,P as ne,l as k,m as Ne,C as ye,T as oe,E as xe,g as be,M as at,Q as st}from"./index-9e7031ee.js";import{I as it}from"./ItemList-97073741.js";import{g as M,I as lt}from"./IconArrowBigUpFilled-4e0d8536.js";function ct({value:e,defaultValue:t,finalValue:r,onChange:n=()=>{}}){const[i,s]=x.useState(t!==void 0?t:r),a=d=>{s(d),n==null||n(d)};return e!==void 0?[e,n,!0]:[i,a,!1]}const dt={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function ut(){const e=x.useRef(0),t=x.useRef(null),[r,n]=x.useState(dt),i=x.useMemo(()=>typeof window<"u"?new ResizeObserver(s=>{const a=s[0];a&&(cancelAnimationFrame(e.current),e.current=requestAnimationFrame(()=>{t.current&&n(a.contentRect)}))}):null,[]);return Ce(()=>(t.current&&(i.observe(t.current),n(t.current.getBoundingClientRect())),()=>{i.disconnect(),e.current&&cancelAnimationFrame(e.current)}),[t.current]),[t,r]}var ft=Object.defineProperty,pt=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,he=Object.getOwnPropertySymbols,gt=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable,we=(e,t,r)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,je=(e,t)=>{for(var r in t||(t={}))gt.call(t,r)&&we(e,r,t[r]);if(he)for(var r of he(t))vt.call(t,r)&&we(e,r,t[r]);return e},Ie=(e,t)=>pt(e,mt(t));const yt=e=>Ze({from:{boxShadow:`0 0 ${m(.5)} 0 ${e}`,opacity:.6},to:{boxShadow:`0 0 ${m(.5)} ${m(4.4)} ${e}`,opacity:0}});function Se(e,t=0){const r={},[n,i]=e.split("-");let s="",a="";return n==="top"&&(r.top=t,a="-50%"),n==="middle"&&(r.top="50%",a="-50%"),n==="bottom"&&(r.bottom=t,a="50%"),i==="start"&&(r.left=t,s="-50%"),i==="center"&&(r.left="50%",s="-50%"),i==="end"&&(r.right=t,s="50%"),r.transform=`translate(${s}, ${a})`,r}var xt=se((e,{radius:t,color:r,position:n,offset:i,inline:s,withBorder:a,withLabel:d,zIndex:c},{size:u})=>{const{background:p}=e.fn.variant({variant:"filled",primaryFallback:!1,color:r||e.primaryColor}),f=m(u);return{root:{position:"relative",display:s?"inline-block":"block"},indicator:Ie(je({},Se(n,i)),{zIndex:c,position:"absolute",[d?"minWidth":"width"]:f,height:f,display:"flex",justifyContent:"center",alignItems:"center",fontSize:e.fontSizes.xs,paddingLeft:d?`calc(${e.spacing.xs} / 2)`:0,paddingRight:d?`calc(${e.spacing.xs} / 2)`:0,borderRadius:e.fn.radius(t),backgroundColor:e.fn.variant({variant:"filled",primaryFallback:!1,color:r||e.primaryColor}).background,border:a?`${m(2)} solid ${e.colorScheme==="dark"?e.colors.dark[7]:e.white}`:void 0,color:e.white,whiteSpace:"nowrap"}),processing:{animation:`${yt(p)} 1000ms linear infinite`},common:Ie(je({},Se(n,i)),{position:"absolute",[d?"minWidth":"width"]:f,height:f,borderRadius:e.fn.radius(t)})}});const bt=xt;var ht=Object.defineProperty,U=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable,_e=(e,t,r)=>t in e?ht(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wt=(e,t)=>{for(var r in t||(t={}))Ae.call(t,r)&&_e(e,r,t[r]);if(U)for(var r of U(t))Be.call(t,r)&&_e(e,r,t[r]);return e},jt=(e,t)=>{var r={};for(var n in e)Ae.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&U)for(var n of U(e))t.indexOf(n)<0&&Be.call(e,n)&&(r[n]=e[n]);return r};const It={position:"top-end",offset:0,inline:!1,withBorder:!1,disabled:!1,processing:!1,size:10,radius:1e3,zIndex:et("app")},O=x.forwardRef((e,t)=>{const r=Ee("Indicator",It,e),{children:n,position:i,offset:s,size:a,radius:d,inline:c,withBorder:u,className:p,color:f,styles:C,label:z,classNames:q,disabled:L,zIndex:G,unstyled:H,processing:J,variant:K}=r,Q=jt(r,["children","position","offset","size","radius","inline","withBorder","className","color","styles","label","classNames","disabled","zIndex","unstyled","processing","variant"]),{classes:_,cx:E}=bt({position:i,offset:s,radius:d,inline:c,color:f,withBorder:u,zIndex:G,withLabel:!!z},{name:"Indicator",classNames:q,styles:C,unstyled:H,variant:K,size:a});return I.createElement(ae,wt({ref:t,className:E(_.root,p)},Q),!L&&I.createElement(I.Fragment,null,I.createElement("div",{className:E(_.indicator,_.common)},z),J&&I.createElement("div",{className:E(_.processing,_.common)})),n)});O.displayName="@mantine/core/Indicator";var St=Object.defineProperty,_t=Object.defineProperties,$t=Object.getOwnPropertyDescriptors,$e=Object.getOwnPropertySymbols,Rt=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable,Re=(e,t,r)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,T=(e,t)=>{for(var r in t||(t={}))Rt.call(t,r)&&Re(e,r,t[r]);if($e)for(var r of $e(t))Pt.call(t,r)&&Re(e,r,t[r]);return e},Ot=(e,t)=>_t(e,$t(t));const D=4,Pe={xs:`${m(3)} ${m(6)}`,sm:`${m(5)} ${m(10)}`,md:`${m(7)} ${m(14)}`,lg:`${m(9)} ${m(16)}`,xl:`${m(12)} ${m(20)}`};var kt=se((e,{fullWidth:t,color:r,radius:n,shouldAnimate:i,transitionDuration:s,transitionTimingFunction:a,orientation:d},{size:c})=>{const u=d==="vertical",p=e.fn.variant({variant:"filled",color:r});return{label:Ot(T(T({ref:M("label")},e.fn.focusStyles()),e.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",borderRadius:e.fn.radius(n),fontWeight:500,fontSize:c in e.fontSizes?e.fontSizes[c]:e.fontSizes.sm,cursor:"pointer",display:"block",textAlign:"center",padding:Pe[c in Pe?c:"sm"],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",color:e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[7],transition:`color ${i?0:s}ms ${a||e.transitionTimingFunction}`,"&:hover":{color:e.colorScheme==="dark"?e.colors.dark[0]:e.black},"&[data-disabled]":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}},"&[data-active]":{"&, &:hover":{color:r||e.colorScheme==="dark"?e.white:e.black}}}),control:{ref:M("control"),position:"relative",boxSizing:"border-box",flex:1,zIndex:2,transition:`border-left-color ${i?0:s}ms ${a||e.transitionTimingFunction}`,"&:not(:first-of-type)":{borderStyle:"solid",borderWidth:u?`${m(1)} 0 0 0`:`0 0 0 ${m(1)}`,borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}},input:{height:0,width:0,position:"absolute",overflow:"hidden",whiteSpace:"nowrap",opacity:0,"&:focus":{outline:"none",[`& + .${M("label")}`]:T({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),"&:focus:not(:focus-visible)":{[`& + .${M("label")}`]:T({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)}},"&:disabled + label":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}}},root:{position:"relative",display:t||u?"flex":"inline-flex",width:u&&!t?"max-content":"auto",flexDirection:u?"column":"row",backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[1],borderRadius:e.fn.radius(n),overflow:"hidden",padding:D},controlActive:{borderLeftColor:"transparent !important",borderTopColor:"transparent !important",[`& + .${M("control")}`]:{[u?"borderTopColor":"borderLeftColor"]:"transparent !important"},borderRadius:e.fn.radius(n),boxShadow:i?r||e.colorScheme==="dark"?"none":e.shadows.xs:void 0,backgroundColor:i?r?p.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white:void 0},indicator:{boxSizing:"border-box",borderRadius:e.fn.radius(n),position:"absolute",zIndex:1,boxShadow:r||e.colorScheme==="dark"?"none":e.shadows.xs,transition:`transform ${i?0:s}ms ${e.transitionTimingFunction}, width ${i?0:s/2}ms ${a||e.transitionTimingFunction}`,backgroundColor:r?p.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white}}});const Ct=kt;var Et=Object.defineProperty,V=Object.getOwnPropertySymbols,Me=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,Oe=(e,t,r)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Nt=(e,t)=>{for(var r in t||(t={}))Me.call(t,r)&&Oe(e,r,t[r]);if(V)for(var r of V(t))ze.call(t,r)&&Oe(e,r,t[r]);return e},At=(e,t)=>{var r={};for(var n in e)Me.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&V)for(var n of V(e))t.indexOf(n)<0&&ze.call(e,n)&&(r[n]=e[n]);return r};const Bt={disabled:!1,size:"sm",transitionDuration:200},ie=x.forwardRef((e,t)=>{var r,n,i,s;const a=Ee("SegmentedControl",Bt,e),{className:d,disabled:c,data:u,name:p,value:f,onChange:C,color:z,fullWidth:q,radius:L,size:G,transitionDuration:H,transitionTimingFunction:J,classNames:K,styles:Q,defaultValue:_,orientation:E,unstyled:De,variant:We,readOnly:Ue}=a,Ve=At(a,["className","disabled","data","name","value","onChange","color","fullWidth","radius","size","transitionDuration","transitionTimingFunction","classNames","styles","defaultValue","orientation","unstyled","variant","readOnly"]),le=tt(),qe=rt(),Le=le.respectReducedMotion?qe:!1,N=u.map(l=>typeof l=="string"?{label:l,value:l}:l),ce=x.useRef(),[de,ue]=x.useState(!1),[$,Ge]=ct({value:f,defaultValue:_,finalValue:Array.isArray(N)&&(s=(i=(r=N.find(l=>!l.disabled))==null?void 0:r.value)!=null?i:(n=N[0])==null?void 0:n.value)!=null?s:null,onChange:C}),{classes:R,cx:fe}=Ct({fullWidth:q,color:z,radius:L,shouldAnimate:Le||!de,transitionDuration:H,transitionTimingFunction:J,orientation:E},{name:"SegmentedControl",classNames:K,styles:Q,unstyled:De,variant:We,size:G}),[F,He]=x.useState({width:0,height:0,translate:[0,0]}),X=nt(p),Y=x.useRef({}),[pe,me]=ut();Ce(()=>{ce.current?ue(!0):(ce.current=!0,ue(!1))}),x.useEffect(()=>{if($ in Y.current&&pe.current){const l=Y.current[$],A=l.getBoundingClientRect(),ge=l.offsetWidth/A.width,ve=A.width*ge||0,Qe=A.height*ge||0,Xe=me.width-l.parentElement.offsetLeft+D-ve,Ye=l.parentElement.offsetLeft-D;He({width:ve,height:Qe,translate:[le.dir==="rtl"?Xe:Ye,l.parentElement.offsetTop-D]})}},[$,me]);const Je=N.map(l=>I.createElement("div",{className:fe(R.control,{[R.controlActive]:$===l.value}),key:l.value},I.createElement("input",{className:R.input,disabled:c||l.disabled,type:"radio",name:X,value:l.value,id:`${X}-${l.value}`,checked:$===l.value,onChange:()=>!Ue&&Ge(l.value)}),I.createElement("label",{className:R.label,"data-active":$===l.value&&!(c||l.disabled)||void 0,"data-disabled":c||l.disabled||void 0,htmlFor:`${X}-${l.value}`,ref:A=>{Y.current[l.value]=A}},l.label))),Ke=ot(pe,t);return N.length===0?null:I.createElement(ae,Nt({className:fe(R.root,d),ref:Ke},Ve),typeof $=="string"&&de&&I.createElement(ae,{component:"span",className:R.indicator,sx:{width:F.width,height:F.height,transform:`translate(${F.translate[0]}px, ${F.translate[1]}px)`}}),Je)});ie.displayName="@mantine/core/SegmentedControl";const w={act:Mt,actable:Fe};function Fe(e,t){if(!e.inventory.monsters[t.monsterIndex])return!1;const n=t.itemId&&e.inventory.items[t.itemId];return!(t.itemId!==void 0&&!n||n&&n.count<=0)}function Mt(e,t){if(!Fe(e,t))return;const r=e.inventory.monsters[t.monsterIndex];r&&W.equipItem(e,r,t.itemId,t.type)}function zt(){const e=j(a=>a.data.inventory.currentMonsterIndex),t=j(a=>a.data.inventory.monsters[e]),r=j(a=>a.data.inventory),n=(a,d)=>{k.setState(c=>{c.modals.itemPicker.opened=!0,c.modals.itemPicker.items=y.util.sortItems(Object.keys(a).map(u=>r.items[u]).filter(Boolean)),t&&t[d]&&c.modals.itemPicker.items.push(void 0),c.modals.itemPicker.callback=u=>{k.setState(p=>{p.modals.itemPicker.opened=!1}),j.setState(p=>{w.act(p.data,{itemId:u==null?void 0:u.id,monsterIndex:e,type:d})})}})},i=()=>{const a=y.util.getBetterItem(r,Z),d=y.util.getBetterItem(r,ee),c=y.util.getBetterItem(r,re),u=y.util.getBetterItem(r,ne),p=y.util.getBetterItem(r,te);j.setState(f=>{a&&w.act(f.data,{itemId:a,type:g.Weapon,monsterIndex:e}),d&&w.act(f.data,{itemId:d,type:g.Armor,monsterIndex:e}),c&&w.act(f.data,{itemId:c,type:g.Rune,monsterIndex:e}),u&&w.act(f.data,{itemId:u,type:g.Ring,monsterIndex:e}),p&&w.act(f.data,{itemId:p,type:g.Amulet,monsterIndex:e})})},s=()=>{j.setState(a=>{w.act(a.data,{itemId:void 0,type:g.Weapon,monsterIndex:e}),w.act(a.data,{itemId:void 0,type:g.Armor,monsterIndex:e}),w.act(a.data,{itemId:void 0,type:g.Rune,monsterIndex:e}),w.act(a.data,{itemId:void 0,type:g.Ring,monsterIndex:e}),w.act(a.data,{itemId:void 0,type:g.Amulet,monsterIndex:e})})};return t?o.jsxs(o.Fragment,{children:[o.jsx(h,{direction:"column",align:"center",children:o.jsx(O,{color:"red",disabled:!y.util.getBetterItem(r,Z),children:o.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>n(Z,g.Weapon),children:t.weapon?o.jsx(B,{src:b.url(v[t.weapon].path),stars:v[t.weapon].stars}):o.jsx(P,{src:b.url(v["Common Axe"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})})}),o.jsxs(h,{direction:"row",justify:"center",gap:"xl",children:[o.jsx(O,{color:"red",disabled:!y.util.getBetterItem(r,ee),mr:"xl",children:o.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>n(ee,g.Armor),children:t.armor?o.jsx(B,{src:b.url(v[t.armor].path),stars:v[t.armor].stars}):o.jsx(P,{src:b.url(v["Common Banded Mail 1 Armor"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})}),o.jsx(O,{color:"red",disabled:!y.util.getBetterItem(r,te),children:o.jsx(S,{variant:"default",h:"auto",p:"md",ml:"xl",onClick:()=>n(te,g.Amulet),children:t.amulet?o.jsx(B,{src:b.url(v[t.amulet].path),stars:v[t.amulet].stars}):o.jsx(P,{src:b.url(v["Common Cameo Blue Amulet"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})})]}),o.jsxs(h,{direction:"row",justify:"center",gap:"md",children:[o.jsx(O,{color:"red",disabled:!y.util.getBetterItem(r,re),children:o.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>n(re,g.Rune),children:t.rune?o.jsx(B,{src:b.url(v[t.rune].path),stars:v[t.rune].stars}):o.jsx(P,{src:b.url(v["Common Generic Rune"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})}),o.jsx(O,{color:"red",disabled:!y.util.getBetterItem(r,ne),children:o.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>n(ne,g.Ring),children:t.ring?o.jsx(B,{src:b.url(v[t.ring].path),stars:v[t.ring].stars}):o.jsx(P,{src:b.url(v["Common Agate Ring"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})})]}),o.jsxs(h,{direction:"row",gap:"md",children:[o.jsx(S,{onClick:i,style:{flex:1},children:"Auto-equip"}),o.jsx(S,{onClick:s,style:{flex:1},color:"red",children:"Unequip"})]})]}):null}const ke={act:Ft,actable:Te};function Te(e,t){const r=e.inventory.monsters[t.monsterIndex];if(!r||e.player.level<=r.level)return!1;const n=W.getMonsterUpgradeCost(r.level);return!(n.gold>e.player.gold||n.food>e.player.food)}function Ft(e,t){if(!Te(e,t))return;const r=e.inventory.monsters[t.monsterIndex];if(!r)return;const n=W.getMonsterUpgradeCost(r.level);e.player.gold-=n.gold,e.player.food-=n.food,r.level++,W.sortMonsters(e)}const Tt=se(e=>({inventoryTop:{[e.fn.largerThan(640)]:{flex:1,height:372}}}));function Ht(){return o.jsxs(h,{direction:"column",gap:"md",mx:"md",my:80,children:[o.jsx(Dt,{}),o.jsx(Wt,{})]})}function Dt(){const{classes:e}=Tt(),t=k(f=>f.segments.inventoryTop),r=f=>{k.setState(C=>{C.segments.inventoryTop=f})},n=j(f=>f.data),i=n.inventory.currentMonsterIndex,s=n.inventory.monsters[i],a=s?b.url(Ne[s.id].path):void 0,d=s&&y.util.getMonsterStats(s),c=s&&y.util.getMonsterUpgradeCost(s==null?void 0:s.level),u=ke.actable(n,{monsterIndex:i}),p=()=>{j.setState(f=>{ke.act(f.data,{monsterIndex:i})})};return o.jsxs(h,{direction:"row",justify:"center",gap:"md",wrap:"wrap",children:[o.jsx(ye,{withBorder:!0,w:"100%",className:e.inventoryTop,children:o.jsxs(h,{direction:"column",align:"center",justify:"center",gap:"md",h:"100%",children:[o.jsx(oe,{order:3,children:s==null?void 0:s.id}),o.jsx(P,{src:a,width:64,height:64,style:{imageRendering:"pixelated"}})]})}),o.jsx(ye,{withBorder:!0,w:"100%",className:e.inventoryTop,children:o.jsxs(h,{direction:"column",gap:"md",children:[o.jsx(ie,{fullWidth:!0,value:t,onChange:r,data:[{label:"Info",value:"info"},{label:"Items",value:"items"}]}),t==="info"&&o.jsxs(o.Fragment,{children:[o.jsxs(h,{align:"center",gap:"md",wrap:"wrap",children:[o.jsx(S,{onClick:p,disabled:!u,leftIcon:o.jsx(lt,{}),children:"Upgrade"}),o.jsxs(h,{gap:"xs",children:[o.jsx(xe,{emoji:"🪙",style:{width:24,height:24}}),o.jsx(oe,{order:5,children:c&&be.formatNumber(c.gold)}),o.jsx(xe,{emoji:"🍏",style:{width:24,height:24}}),o.jsx(oe,{order:5,children:c&&be.formatNumber(c.food)})]})]}),d&&o.jsx(at,{...d})]}),t==="items"&&o.jsx(zt,{})]})})]})}function Wt(){const e=k(r=>r.segments.inventoryBottom),t=r=>{k.setState(n=>{n.segments.inventoryBottom=r})};return o.jsxs(o.Fragment,{children:[o.jsx(ie,{value:e,onChange:t,data:[{label:"Monsters",value:"monsters"},{label:"Items",value:"items"}]}),e==="monsters"&&o.jsx(Ut,{}),e==="items"&&o.jsx(Vt,{})]})}function Ut(){const e=j(r=>r.data),t=r=>{j.setState(n=>{n.data.inventory.currentMonsterIndex=r})};return o.jsx(o.Fragment,{children:o.jsx(h,{direction:"row",gap:"md",wrap:"wrap",children:e.inventory.monsters.map((r,n)=>o.jsx(st,{src:b.url(Ne[r.id].path),count:r.level,onClick:()=>t(n),selected:e.inventory.currentMonsterIndex===n},n))})})}function Vt(){const e=j(r=>r.data),t=x.useMemo(()=>y.util.sortItems(Object.values(e.inventory.items)),[e.inventory.items]);return o.jsx(o.Fragment,{children:o.jsx(h,{direction:"row",gap:"md",wrap:"wrap",children:o.jsx(it,{level:e.player.level,gold:e.player.gold,diamond:e.player.diamond,food:e.player.food,items:t})})})}export{Ht as default};
