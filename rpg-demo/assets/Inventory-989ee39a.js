import{r as f,k as ne,b as m,c as se,u as Ae,d as Fe,l as De,m as Be,R as $,n as ze,B as K,j as n,F as v,h as S,o as _,w as Ue,I as p,f as u,i as g,q as Ve,s as We,t as Le,v as qe,x as T,C as Q,T as M,E as Y,g as b,y as I}from"./index-40a7cff9.js";import{g as P,u as ae,m as le,a as B,I as Ge,M as He}from"./MonsterStats-cbc00d77.js";import{u as x}from"./gameStore-1c45f400.js";function Xe({value:e,defaultValue:t,finalValue:r,onChange:o=()=>{}}){const[s,a]=f.useState(t!==void 0?t:r),i=d=>{a(d),o==null||o(d)};return e!==void 0?[e,o,!0]:[s,i,!1]}const Je={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function Ke(){const e=f.useRef(0),t=f.useRef(null),[r,o]=f.useState(Je),s=f.useMemo(()=>typeof window<"u"?new ResizeObserver(a=>{const i=a[0];i&&(cancelAnimationFrame(e.current),e.current=requestAnimationFrame(()=>{t.current&&o(i.contentRect)}))}):null,[]);return ne(()=>(t.current&&(s.observe(t.current),o(t.current.getBoundingClientRect())),()=>{s.disconnect(),e.current&&cancelAnimationFrame(e.current)}),[t.current]),[t,r]}var Qe=Object.defineProperty,Ye=Object.defineProperties,Ze=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,ee=(e,t,r)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))et.call(t,r)&&ee(e,r,t[r]);if(Z)for(var r of Z(t))tt.call(t,r)&&ee(e,r,t[r]);return e},rt=(e,t)=>Ye(e,Ze(t));const N=4,te={xs:`${m(3)} ${m(6)}`,sm:`${m(5)} ${m(10)}`,md:`${m(7)} ${m(14)}`,lg:`${m(9)} ${m(16)}`,xl:`${m(12)} ${m(20)}`};var ot=se((e,{fullWidth:t,color:r,radius:o,shouldAnimate:s,transitionDuration:a,transitionTimingFunction:i,orientation:d},{size:c})=>{const h=d==="vertical",w=e.fn.variant({variant:"filled",color:r});return{label:rt(E(E({ref:P("label")},e.fn.focusStyles()),e.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",borderRadius:e.fn.radius(o),fontWeight:500,fontSize:c in e.fontSizes?e.fontSizes[c]:e.fontSizes.sm,cursor:"pointer",display:"block",textAlign:"center",padding:te[c in te?c:"sm"],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",color:e.colorScheme==="dark"?e.colors.dark[1]:e.colors.gray[7],transition:`color ${s?0:a}ms ${i||e.transitionTimingFunction}`,"&:hover":{color:e.colorScheme==="dark"?e.colors.dark[0]:e.black},"&[data-disabled]":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}},"&[data-active]":{"&, &:hover":{color:r||e.colorScheme==="dark"?e.white:e.black}}}),control:{ref:P("control"),position:"relative",boxSizing:"border-box",flex:1,zIndex:2,transition:`border-left-color ${s?0:a}ms ${i||e.transitionTimingFunction}`,"&:not(:first-of-type)":{borderStyle:"solid",borderWidth:h?`${m(1)} 0 0 0`:`0 0 0 ${m(1)}`,borderColor:e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[3]}},input:{height:0,width:0,position:"absolute",overflow:"hidden",whiteSpace:"nowrap",opacity:0,"&:focus":{outline:"none",[`& + .${P("label")}`]:E({},e.focusRing==="always"||e.focusRing==="auto"?e.focusRingStyles.styles(e):e.focusRingStyles.resetStyles(e)),"&:focus:not(:focus-visible)":{[`& + .${P("label")}`]:E({},e.focusRing==="auto"||e.focusRing==="never"?e.focusRingStyles.resetStyles(e):null)}},"&:disabled + label":{"&, &:hover":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}}},root:{position:"relative",display:t||h?"flex":"inline-flex",width:h&&!t?"max-content":"auto",flexDirection:h?"column":"row",backgroundColor:e.colorScheme==="dark"?e.colors.dark[8]:e.colors.gray[1],borderRadius:e.fn.radius(o),overflow:"hidden",padding:N},controlActive:{borderLeftColor:"transparent !important",borderTopColor:"transparent !important",[`& + .${P("control")}`]:{[h?"borderTopColor":"borderLeftColor"]:"transparent !important"},borderRadius:e.fn.radius(o),boxShadow:s?r||e.colorScheme==="dark"?"none":e.shadows.xs:void 0,backgroundColor:s?r?w.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white:void 0},indicator:{boxSizing:"border-box",borderRadius:e.fn.radius(o),position:"absolute",zIndex:1,boxShadow:r||e.colorScheme==="dark"?"none":e.shadows.xs,transition:`transform ${s?0:a}ms ${e.transitionTimingFunction}, width ${s?0:a/2}ms ${i||e.transitionTimingFunction}`,backgroundColor:r?w.background:e.colorScheme==="dark"?e.colors.dark[5]:e.white}}});const nt=ot;var st=Object.defineProperty,A=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,re=(e,t,r)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,at=(e,t)=>{for(var r in t||(t={}))ie.call(t,r)&&re(e,r,t[r]);if(A)for(var r of A(t))ce.call(t,r)&&re(e,r,t[r]);return e},lt=(e,t)=>{var r={};for(var o in e)ie.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&A)for(var o of A(e))t.indexOf(o)<0&&ce.call(e,o)&&(r[o]=e[o]);return r};const it={disabled:!1,size:"sm",transitionDuration:200},z=f.forwardRef((e,t)=>{var r,o,s,a;const i=Ae("SegmentedControl",it,e),{className:d,disabled:c,data:h,name:w,value:k,onChange:fe,color:me,fullWidth:pe,radius:ge,size:ve,transitionDuration:he,transitionTimingFunction:xe,classNames:ye,styles:be,defaultValue:we,orientation:je,unstyled:Se,variant:Ie,readOnly:ke}=i,Ce=lt(i,["className","disabled","data","name","value","onChange","color","fullWidth","radius","size","transitionDuration","transitionTimingFunction","classNames","styles","defaultValue","orientation","unstyled","variant","readOnly"]),U=Fe(),Re=De(),$e=U.respectReducedMotion?Re:!1,C=h.map(l=>typeof l=="string"?{label:l,value:l}:l),V=f.useRef(),[W,L]=f.useState(!1),[y,_e]=Xe({value:k,defaultValue:we,finalValue:Array.isArray(C)&&(a=(s=(r=C.find(l=>!l.disabled))==null?void 0:r.value)!=null?s:(o=C[0])==null?void 0:o.value)!=null?a:null,onChange:fe}),{classes:j,cx:q}=nt({fullWidth:pe,color:me,radius:ge,shouldAnimate:$e||!W,transitionDuration:he,transitionTimingFunction:xe,orientation:je},{name:"SegmentedControl",classNames:ye,styles:be,unstyled:Se,variant:Ie,size:ve}),[O,Pe]=f.useState({width:0,height:0,translate:[0,0]}),F=Be(w),D=f.useRef({}),[G,H]=Ke();ne(()=>{V.current?L(!0):(V.current=!0,L(!1))}),f.useEffect(()=>{if(y in D.current&&G.current){const l=D.current[y],R=l.getBoundingClientRect(),X=l.offsetWidth/R.width,J=R.width*X||0,Ee=R.height*X||0,Ne=H.width-l.parentElement.offsetLeft+N-J,Te=l.parentElement.offsetLeft-N;Pe({width:J,height:Ee,translate:[U.dir==="rtl"?Ne:Te,l.parentElement.offsetTop-N]})}},[y,H]);const Oe=C.map(l=>$.createElement("div",{className:q(j.control,{[j.controlActive]:y===l.value}),key:l.value},$.createElement("input",{className:j.input,disabled:c||l.disabled,type:"radio",name:F,value:l.value,id:`${F}-${l.value}`,checked:y===l.value,onChange:()=>!ke&&_e(l.value)}),$.createElement("label",{className:j.label,"data-active":y===l.value&&!(c||l.disabled)||void 0,"data-disabled":c||l.disabled||void 0,htmlFor:`${F}-${l.value}`,ref:R=>{D.current[l.value]=R}},l.label))),Me=ze(G,t);return C.length===0?null:$.createElement(K,at({className:q(j.root,d),ref:Me},Ce),typeof y=="string"&&W&&$.createElement(K,{component:"span",className:j.indicator,sx:{width:O.width,height:O.height,transform:`translate(${O.translate[0]}px, ${O.translate[1]}px)`}}),Oe)});z.displayName="@mantine/core/SegmentedControl";const ct={act:dt,actable:de};function de(e,t){if(!e.inventory.monsters[t.monsterIndex])return!1;const o=t.itemId&&e.inventory.items[t.itemId];return!(t.itemId!==void 0&&!o||o&&o.count<=0)}function dt(e,t){if(!de(e,t))return;const r=e.inventory.monsters[t.monsterIndex];if(!r)return;const o=t.itemId&&e.inventory.items[t.itemId],s=r[t.type];s&&(e.inventory.items[s]||(e.inventory.items[s]={id:s,count:0}),e.inventory.items[s].count++),r[t.type]=o?o.id:void 0,o&&o.count--,t.itemId&&o&&o.count===0&&delete e.inventory.items[t.itemId]}function ut(){const e=x(s=>s.data.inventory.currentMonsterIndex),t=x(s=>s.data.inventory.monsters[e]),r=x(s=>s.data.inventory),o=(s,a)=>{T.setState(i=>{i.modals.itemPicker.opened=!0,i.modals.itemPicker.items=Object.keys(s).map(d=>r.items[d]).filter(Boolean),t&&t[a]&&i.modals.itemPicker.items.push(void 0),i.modals.itemPicker.callback=d=>{T.setState(c=>{c.modals.itemPicker.opened=!1}),x.setState(c=>{ct.act(c.data,{itemId:d==null?void 0:d.id,monsterIndex:e,type:a})})}})};return t?n.jsxs(n.Fragment,{children:[n.jsx(v,{direction:"column",align:"center",children:n.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>o(Ue,_.Weapon),children:t.weapon?n.jsx(p,{src:u.url(g[t.weapon].path),width:32,height:32}):n.jsx(p,{src:u.url(g["Common Axe"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})}),n.jsxs(v,{direction:"row",justify:"center",gap:"xl",children:[n.jsx(S,{variant:"default",h:"auto",p:"md",mr:"xl",onClick:()=>o(Ve,_.Armor),children:t.armor?n.jsx(p,{src:u.url(g[t.armor].path),width:32,height:32}):n.jsx(p,{src:u.url(g["Common Banded Mail Armor"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})}),n.jsx(S,{variant:"default",h:"auto",p:"md",ml:"xl",onClick:()=>o(We,_.Amulet),children:t.amulet?n.jsx(p,{src:u.url(g[t.amulet].path),width:32,height:32}):n.jsx(p,{src:u.url(g["Common Cameo Blue Amulet"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})]}),n.jsxs(v,{direction:"row",justify:"center",gap:"md",children:[n.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>o(Le,_.Rune),children:t.rune?n.jsx(p,{src:u.url(g[t.rune].path),width:32,height:32}):n.jsx(p,{src:u.url(g["Common Generic Rune"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})}),n.jsx(S,{variant:"default",h:"auto",p:"md",onClick:()=>o(qe,_.Ring),children:t.ring?n.jsx(p,{src:u.url(g[t.ring].path),width:32,height:32}):n.jsx(p,{src:u.url(g["Common Agate Ring"].path),width:32,height:32,style:{filter:"blur(1px) contrast(50%)"}})})]})]}):null}const oe={act:ft,actable:ue};function ue(e,t){const r=e.inventory.monsters[t.monsterIndex];if(!r)return!1;const o=ae.getMonsterUpgradeCost(r.level);return!(o.gold>e.player.gold||o.food>e.player.food)}function ft(e,t){if(!ue(e,t))return;const r=e.inventory.monsters[t.monsterIndex];if(!r)return;const o=ae.getMonsterUpgradeCost(r.level);e.player.gold-=o.gold,e.player.food-=o.food,r.level++}const mt=se(e=>({inventoryTop:{[e.fn.largerThan(640)]:{flex:1,height:320}}}));function wt(){return n.jsxs(v,{direction:"column",gap:"md",mx:"md",my:80,children:[n.jsx(pt,{}),n.jsx(gt,{})]})}function pt(){const{classes:e}=mt(),[t,r]=f.useState("info"),o=x(k=>k.data),s=o.inventory.currentMonsterIndex,a=o.inventory.monsters[s],i=a?u.url(le[a.id].path):void 0,d=a&&B.util.getMonsterStats(a.id,a.level),c=a&&B.util.getMonsterUpgradeCost(a==null?void 0:a.level),h=oe.actable(o,{monsterIndex:s}),w=()=>{x.setState(k=>{oe.act(k.data,{monsterIndex:s})})};return n.jsxs(v,{direction:"row",justify:"center",gap:"md",wrap:"wrap",children:[n.jsx(Q,{withBorder:!0,w:"100%",className:e.inventoryTop,children:n.jsxs(v,{direction:"column",align:"center",justify:"center",gap:"md",h:"100%",children:[n.jsx(M,{order:3,children:a==null?void 0:a.id}),n.jsx(p,{src:i,width:64,height:64,style:{imageRendering:"pixelated"}})]})}),n.jsx(Q,{withBorder:!0,w:"100%",className:e.inventoryTop,children:n.jsxs(v,{direction:"column",gap:"md",children:[n.jsx(z,{fullWidth:!0,value:t,onChange:r,data:[{label:"Info",value:"info"},{label:"Items",value:"items"}]}),t==="info"&&n.jsxs(n.Fragment,{children:[n.jsxs(v,{align:"center",gap:"md",wrap:"wrap",children:[n.jsxs(v,{gap:"xs",children:[n.jsx(M,{order:5,children:"Cost:"}),n.jsx(Y,{emoji:"ðŸª™",style:{width:24,height:24}}),n.jsx(M,{order:5,children:c&&b.formatNumber(c.gold)}),n.jsx(Y,{emoji:"ðŸ",style:{width:24,height:24}}),n.jsx(M,{order:5,children:c&&b.formatNumber(c.food)})]}),n.jsx(S,{onClick:w,disabled:!h,leftIcon:n.jsx(Ge,{}),children:"Upgrade"})]}),d&&n.jsx(He,{...d})]}),t==="items"&&n.jsx(ut,{})]})})]})}function gt(){const[e,t]=f.useState("monsters");return n.jsxs(n.Fragment,{children:[n.jsx(z,{value:e,onChange:t,data:[{label:"Monsters",value:"monsters"},{label:"Items",value:"items"}]}),e==="monsters"&&n.jsx(vt,{}),e==="items"&&n.jsx(ht,{})]})}function vt(){const e=x(r=>r.data),t=r=>{x.setState(o=>{o.data.inventory.currentMonsterIndex=r})};return n.jsx(n.Fragment,{children:n.jsx(v,{direction:"row",gap:"md",wrap:"wrap",children:e.inventory.monsters.map((r,o)=>n.jsx(I,{src:u.url(le[r.id].path),count:r.level,onClick:()=>t(o),selected:e.inventory.currentMonsterIndex===o},o))})})}function ht(){const e=x(o=>o.data),t=o=>{T.setState(s=>{s.modals.itemInfo.opened=!0,s.modals.itemInfo.item=o})},r=(o,s)=>{T.setState(a=>{a.modals.itemInfo.opened=!0,a.modals.itemInfo.other={name:o,text:s}})};return n.jsx(n.Fragment,{children:n.jsxs(v,{direction:"row",gap:"md",wrap:"wrap",children:[n.jsx(I,{emoji:"â­",count:e.player.level,onClick:()=>r("level",`${b.formatNumber(e.player.xp,!0)} / ${b.formatNumber(B.util.getLevelUpXp(e.player.level),!0)}`)}),n.jsx(I,{emoji:"ðŸª™",count:e.player.gold,onClick:()=>r("gold",b.formatNumber(e.player.gold,!0))}),n.jsx(I,{emoji:"ðŸ’Ž",count:e.player.diamond,onClick:()=>r("diamond",b.formatNumber(e.player.diamond,!0))}),n.jsx(I,{emoji:"ðŸ",count:e.player.food,onClick:()=>r("food",b.formatNumber(e.player.food,!0))}),Object.values(e.inventory.items).map((o,s)=>n.jsx(I,{src:u.url(g[o.id].path),count:o.count,onClick:()=>t(o)},s))]})})}export{wt as default};
